(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const types_1=require("./types");class Ai{constructor(e){this.board=e}minimax(e,t){if(e.hasWinner())return"X"===e.getWinner()?types_1.AiSolution.XWins:types_1.AiSolution.OWins;const i=e.getAvailableSquares();return 0===i.length?types_1.AiSolution.Draw:t?i.reduce((t,i)=>Math.max(t,this.minimax(e.clone().setSquare(i),!1)),-1/0):i.reduce((t,i)=>Math.min(t,this.minimax(e.clone().setSquare(i),!0)),1/0)}pickSquare(){let e;const t="O"===this.board.getLastPlayer(),i=t?types_1.AiSolution.XWins:types_1.AiSolution.OWins,s=this.board.getAvailableSquares().map(e=>[e,this.minimax(this.board.clone().setSquare(e),!t)]);return console.log(s),(e=s.find(([e,t])=>t===i))?e[0]:(e=s.find(([e,t])=>t===types_1.AiSolution.Draw))?e[0]:s[0][0]}}exports.default=Ai;

},{"./types":7}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Board{constructor(e,t){this.initSquares(e),this.lastPlayer=t}initSquares(e){this.squares=Object.assign({1:void 0,2:void 0,3:void 0,4:void 0,5:void 0,6:void 0,7:void 0,8:void 0,9:void 0},e)}clone(){return new Board(Object.assign({},this.squares),this.lastPlayer)}getLastPlayer(){return this.lastPlayer}getSquare(e){return this.squares[e]}setSquare(e){if(void 0!==this.getSquare(e))throw new Error(`${e} already has a value`);return this.squares[e]=this.getCurrentPlayer(),this}hasWinner(){const e=[[1,2,3],[4,5,6],[7,8,9],[1,4,7],[2,5,8],[3,6,9],[1,5,9],[7,5,3]];for(const t of e){if(t.reduce((e,t,i,r)=>{if(0===i)return void 0!==this.getSquare(t);if(!e)return!1;const s=this.getSquare(t),n=this.getSquare(r[i-1]);return void 0!==n&&s===n},!1))return this.winningLine=t,!0}return!1}getWinner(){const e=this.getWinningLine();return void 0!==e?this.getSquare(e[0]):void 0}getWinningLine(){return void 0===this.winningLine&&this.hasWinner(),this.winningLine}getAvailableSquares(){return Object.keys(this.squares).map(e=>{return Number(e)}).map(e=>void 0===this.getSquare(e)?e:void 0).filter(e=>void 0!==e)}reset(){return this.initSquares(),this.winningLine=void 0,this.lastPlayer=void 0,this}getCurrentPlayer(){let e;return e=void 0===this.lastPlayer?"X":"X"===this.lastPlayer?"O":"X",this.lastPlayer=e}}exports.default=Board;

},{}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const GRID_SIZE=100,PADDING=10;class Canvas{constructor(t){this.element=t,this.init()}onClick(t){this.onClickCallback=t}reset(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderGrid()}renderGrid(){this.context.lineWidth=1,this.context.strokeStyle="black";for(let t=0;t<3;t++)for(let e=0;e<3;e++){const[s,i]=this.getPositions(e,t);this.context.strokeRect(s+1,i+1,GRID_SIZE,GRID_SIZE)}}renderCircle(t,e){const[s,i]=this.getPositions(t,e),n=(GRID_SIZE-2*PADDING)/2;this.context.beginPath(),this.context.lineWidth=3,this.context.strokeStyle="blue",this.context.arc(s+n+PADDING,i+n+PADDING,n,0,2*Math.PI),this.context.stroke(),this.context.closePath()}renderCross(t,e){const[s,i]=this.getPositions(t,e),n=s+PADDING,o=s+GRID_SIZE-PADDING,c=i+PADDING,h=i+GRID_SIZE-PADDING;this.context.beginPath(),this.context.lineWidth=3,this.context.strokeStyle="orange",this.context.moveTo(n,c),this.context.lineTo(o,h),this.context.moveTo(n,h),this.context.lineTo(o,c),this.context.stroke(),this.context.closePath()}renderWinningLine(t,e,s,i){const n=GRID_SIZE/2,o=Number(t)*GRID_SIZE+n,c=Number(e)*GRID_SIZE+n,h=Number(s)*GRID_SIZE+n,a=Number(i)*GRID_SIZE+n;this.context.beginPath(),this.context.lineWidth=4,this.context.strokeStyle="red",this.context.moveTo(o,c),this.context.lineTo(h,a),this.context.stroke(),this.context.closePath()}init(){this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width","302"),this.canvas.setAttribute("height","302"),this.element.append(this.canvas),this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("click",this.handleClick.bind(this))}handleClick(t){if(this.onClickCallback){const e=Math.floor((t.clientX-this.canvas.offsetLeft)/GRID_SIZE),s=Math.floor((t.clientY-this.canvas.offsetTop)/GRID_SIZE);this.onClickCallback(e,s)}}getPositions(t,e){return[Number(t)*GRID_SIZE,Number(e)*GRID_SIZE]}}exports.default=Canvas;

},{}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Ai_1=require("./Ai"),Board_1=require("./Board"),Canvas_1=require("./Canvas"),GridHelper_1=require("./GridHelper");class Game{constructor(e,r=!1){this.board=new Board_1.default,this.ai=r?new Ai_1.default(this.board):void 0,this.canvas=new Canvas_1.default(e),this.canvas.onClick(this.handleClick.bind(this)),this.canvas.renderGrid(),this.chooseSquare(...GridHelper_1.default.fromSquareId(this.ai.pickSquare()))}handleClick(e,r){this.board.hasWinner()||0===this.board.getAvailableSquares().length?this.reset():(this.chooseSquare(e,r),!this.board.hasWinner()&&this.board.getAvailableSquares().length>0&&this.ai&&this.chooseSquare(...GridHelper_1.default.fromSquareId(this.ai.pickSquare())))}chooseSquare(e,r){try{this.board.setSquare(GridHelper_1.default.toSquareId(e,r));const a=this.board.getSquare(GridHelper_1.default.toSquareId(e,r));if("X"===a?this.canvas.renderCross(e,r):"O"===a&&this.canvas.renderCircle(e,r),this.board.hasWinner()){const e=this.board.getWinningLine(),[r,a]=GridHelper_1.default.fromSquareId(e[0]),[i,s]=GridHelper_1.default.fromSquareId(e[2]);this.canvas.renderWinningLine(r,a,i,s)}}catch(e){}}reset(){this.board.reset(),this.canvas.reset()}}exports.default=Game;

},{"./Ai":1,"./Board":2,"./Canvas":3,"./GridHelper":5}],5:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const GRID=[[1,2,3],[4,5,6],[7,8,9]],GridHelper={fromSquareId:e=>{for(const r in GRID)for(const t in GRID[r])if(GRID[r][t]===e)return[Number(t),Number(r)]},toSquareId:(e,r)=>GRID[r][e]};exports.default=GridHelper;

},{}],6:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Game_1=require("./Game");new Game_1.default(document.getElementById("game"),!0);

},{"./Game":4}],7:[function(require,module,exports){
"use strict";var AiSolution;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AiSolution=void 0,function(i){i[i.XWins=10]="XWins",i[i.OWins=-10]="OWins",i[i.Draw=0]="Draw"}(AiSolution=exports.AiSolution||(exports.AiSolution={}));

},{}]},{},[6]);
