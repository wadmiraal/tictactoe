<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css" media="screen" />
  <script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
  <script type="text/javascript" src="tictactoe.js"></script>

  <script>
  $(document).ready(function() {
    var game = new TicTacToe(true);
    
    module("Game initializing");
    
    test("Try finding all 9 squares, even with weird class names", function() {
      equal(game.squares.length, 9, "Should find 9 squares.");
    });
    
    module("Game functions");
    
    test("Try switching player", function() {
      var old = game.currentPlayer;
      
      game.changePlayer();
      
      notEqual(old, game.currentPlayer, "Change player.");
    });
    
    test("Try playing/winning", function() {
      var linesToCheck = [game.topRow, game.bottomRow, game.centerRow, game.leftCol, game.middleCol, game.rightCol, game.diagonal1, game.diagonal2];
      
      ok(!game.win(linesToCheck), "Should not have a winner yet.");
      
      // Game situation before triggering the win:
      // | X | X |   |
      // |   | 0 | X |
      // |   | 0 | 0 |
      
      // Try the direct "store" method as well as triggering a click event.
      game.store('TL', game.currentPlayer);
      game.changePlayer();
      game.store('BR', game.currentPlayer);
      game.changePlayer();
      game.store('TM', game.currentPlayer);
      game.changePlayer();
      var element = document.getElementById('BM');
      game.click(element)
      game.changePlayer();
      element = document.getElementById('CR');
      game.click(element)
      game.changePlayer();
      element = document.getElementById('CM');
      game.click(element)
      game.changePlayer();
      
      // Try playing an already played square, with store method and by calling
      // the click method
      ok(!game.store('TL', game.currentPlayer), "Should not be able to play a same square twice.");
      
      var topLeft = document.getElementById('TL');
      ok(!game.click(topLeft), "Should not be able to play a same square twice.");
      
      // Should still not have a winner
      ok(!game.win(linesToCheck), "Should not have a winner yet.");
      
      // Play the top-right square and win
      ok(!game.store('TR', game.currentPlayer), "Should have a winner.");
    });

  });

  </script>
  
</head>
<body>
  <h1 id="qunit-header">QUnit example</h1>
  <h2 id="qunit-banner"></h2>
  <div id="qunit-testrunner-toolbar"></div>
  <h2 id="qunit-userAgent"></h2>
  <ol id="qunit-tests"></ol>
  <div id="qunit-fixture">      
    <div class="tictactoe-square hel-lo" id="TL">&nbsp;</div>
    <div class="tictactoe-square hel_lo w-45orld" id="TM">&nbsp;</div>
    <div class="he45_llo tictactoe-square" id="TR">&nbsp;</div>
    <div class="hel__-lo wor58ld tictactoe-square" id="CL">&nbsp;</div>
    <div class="he_-2_llo tictactoe-square wo-as_rld" id="CM">&nbsp;</div>
    <div class="hel4lo w21orld tictactoe-square t__here" id="CR">&nbsp;</div>
    <div class="he_jllo wo98rld tictactoe-square there is" id="BL">&nbsp;</div>
    <div class="hello tictactoe-square world there" id="BM">&nbsp;</div>
    <div class="tictactoe-square" id="BR">&nbsp;</div>
  </div>
</body>
</html>